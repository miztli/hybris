<p class=isa_info ><code>
<font color="#404040"><b>package&nbsp;</b></font><font color="#000000">concerttours.daos.impl;</font><br />
<font color="#404040"><b>import&nbsp;static&nbsp;</b></font><font color="#000000">org.junit.Assert.assertTrue;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">de.hybris.bootstrap.annotations.IntegrationTest;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">de.hybris.platform.servicelayer.ServicelayerTransactionalTest;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">de.hybris.platform.servicelayer.model.ModelService;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">java.util.List;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">javax.annotation.Resource;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">org.junit.Assert;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">org.junit.Test;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">concerttours.daos.BandDAO;</font><br />
<font color="#404040"><b>import&nbsp;</b></font><font color="#000000">concerttours.model.BandModel;</font><br />
<font color="#ffffff">&nbsp;</font><br />
<font color="#3f5fbf">/**</font><br />
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;The&nbsp;purpose&nbsp;of&nbsp;this&nbsp;test&nbsp;is&nbsp;to&nbsp;illustrate&nbsp;DAO&nbsp;best&nbsp;practices&nbsp;and&nbsp;behaviour.</font><br />
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*</font><br />
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;The&nbsp;DAO&nbsp;logic&nbsp;is&nbsp;factored&nbsp;into&nbsp;a&nbsp;separate&nbsp;POJO.&nbsp;Stepping&nbsp;into&nbsp;these&nbsp;will&nbsp;illustrate&nbsp;how&nbsp;to&nbsp;write&nbsp;and&nbsp;execute</font><br />
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;FlexibleSearchQueries&nbsp;-&nbsp;the&nbsp;basis&nbsp;on&nbsp;which&nbsp;most&nbsp;hybris&nbsp;DAOs&nbsp;operate.</font><br />
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*/</font><br />
<font color="#646464">@IntegrationTest</font><br />
<font color="#404040"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">DefaultBandDAOIntegrationTest&nbsp;</font><font color="#404040"><b>extends&nbsp;</b></font><font color="#000000">ServicelayerTransactionalTest</font><br />
<font color="#000000">{</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**&nbsp;As&nbsp;this&nbsp;is&nbsp;an&nbsp;integration&nbsp;test,&nbsp;the&nbsp;class&nbsp;(object)&nbsp;being&nbsp;tested&nbsp;gets&nbsp;injected&nbsp;here.&nbsp;*/</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#646464">@Resource</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>private&nbsp;</b></font><font color="#000000">BandDAO&nbsp;bandDAO;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**&nbsp;Platform's&nbsp;ModelService&nbsp;used&nbsp;for&nbsp;creation&nbsp;of&nbsp;test&nbsp;data.&nbsp;*/</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#646464">@Resource</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>private&nbsp;</b></font><font color="#000000">ModelService&nbsp;modelService;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**&nbsp;Name&nbsp;of&nbsp;test&nbsp;band.&nbsp;*/</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>private&nbsp;static&nbsp;final&nbsp;</b></font><font color="#000000">String&nbsp;BAND_CODE&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;ROCK-11&#34;</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**&nbsp;Name&nbsp;of&nbsp;test&nbsp;band.&nbsp;*/</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>private&nbsp;static&nbsp;final&nbsp;</b></font><font color="#000000">String&nbsp;BAND_NAME&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;Ladies&nbsp;of&nbsp;Rock&#34;</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**&nbsp;History&nbsp;of&nbsp;test&nbsp;band.&nbsp;*/</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>private&nbsp;static&nbsp;final&nbsp;</b></font><font color="#000000">String&nbsp;BAND_HISTORY&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;All&nbsp;female&nbsp;rock&nbsp;band&nbsp;formed&nbsp;in&nbsp;Munich&nbsp;in&nbsp;the&nbsp;late&nbsp;1990s&#34;</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**&nbsp;Albums&nbsp;sold&nbsp;*/</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>private&nbsp;static&nbsp;final&nbsp;</b></font><font color="#000000">Long&nbsp;ALBUMS_SOLD&nbsp;=&nbsp;Long.valueOf</font><font color="#000000">(</font><font color="#990000">1000L</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#646464">@Test</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">bandDAOTest</font><font color="#000000">()</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">{</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;check&nbsp;that&nbsp;our&nbsp;test&nbsp;band&nbsp;is&nbsp;not&nbsp;already&nbsp;present&nbsp;in&nbsp;the&nbsp;database</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&lt;BandModel&gt;&nbsp;bandsByCode&nbsp;=&nbsp;bandDAO.findBandsByCode</font><font color="#000000">(</font><font color="#000000">BAND_CODE</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#2a00ff">&#34;No&nbsp;Band&nbsp;should&nbsp;be&nbsp;returned&#34;</font><font color="#000000">,&nbsp;bandsByCode.isEmpty</font><font color="#000000">())</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;retrieve&nbsp;all&nbsp;bands&nbsp;currently&nbsp;in&nbsp;the&nbsp;database</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&lt;BandModel&gt;&nbsp;allBands&nbsp;=&nbsp;bandDAO.findBands</font><font color="#000000">()</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">size&nbsp;=&nbsp;allBands.size</font><font color="#000000">()</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;add&nbsp;our&nbsp;test&nbsp;band&nbsp;to&nbsp;the&nbsp;database</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>final&nbsp;</b></font><font color="#000000">BandModel&nbsp;bandModel&nbsp;=&nbsp;modelService.create</font><font color="#000000">(</font><font color="#000000">BandModel.</font><font color="#404040"><b>class</b></font><font color="#000000">)</font><font color="#000000">;&nbsp;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bandModel.setCode</font><font color="#000000">(</font><font color="#000000">BAND_CODE</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bandModel.setName</font><font color="#000000">(</font><font color="#000000">BAND_NAME</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bandModel.setHistory</font><font color="#000000">(</font><font color="#000000">BAND_HISTORY</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bandModel.setAlbumSales</font><font color="#000000">(</font><font color="#000000">ALBUMS_SOLD</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">modelService.save</font><font color="#000000">(</font><font color="#000000">bandModel</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;check&nbsp;we&nbsp;now&nbsp;get&nbsp;one&nbsp;more&nbsp;band&nbsp;back&nbsp;than&nbsp;previously&nbsp;and&nbsp;our&nbsp;test&nbsp;band&nbsp;is&nbsp;in&nbsp;the&nbsp;list</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">allBands&nbsp;=&nbsp;bandDAO.findBands</font><font color="#000000">()</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Assert.assertEquals</font><font color="#000000">(</font><font color="#000000">size&nbsp;+&nbsp;</font><font color="#990000">1</font><font color="#000000">,&nbsp;allBands.size</font><font color="#000000">())</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Assert.assertTrue</font><font color="#000000">(</font><font color="#2a00ff">&#34;band&nbsp;not&nbsp;found&#34;</font><font color="#000000">,&nbsp;allBands.contains</font><font color="#000000">(</font><font color="#000000">bandModel</font><font color="#000000">))</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;check&nbsp;we&nbsp;can&nbsp;locate&nbsp;our&nbsp;test&nbsp;band&nbsp;by&nbsp;its&nbsp;code</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bandsByCode&nbsp;=&nbsp;bandDAO.findBandsByCode</font><font color="#000000">(</font><font color="#000000">BAND_CODE</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Assert.assertEquals</font><font color="#000000">(</font><font color="#2a00ff">&#34;Did&nbsp;not&nbsp;find&nbsp;the&nbsp;Band&nbsp;we&nbsp;just&nbsp;saved&#34;</font><font color="#000000">,&nbsp;</font><font color="#990000">1</font><font color="#000000">,&nbsp;bandsByCode.size</font><font color="#000000">())</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Assert.assertEquals</font><font color="#000000">(</font><font color="#2a00ff">&#34;Retrieved&nbsp;Band's&nbsp;code&nbsp;attribute&nbsp;incorrect&#34;</font><font color="#000000">,&nbsp;BAND_CODE,&nbsp;bandsByCode.get</font><font color="#000000">(</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">.getCode</font><font color="#000000">())</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Assert.assertEquals</font><font color="#000000">(</font><font color="#2a00ff">&#34;Retrieved&nbsp;Band's&nbsp;name&nbsp;attribute&nbsp;incorrect&#34;</font><font color="#000000">,&nbsp;BAND_NAME,&nbsp;bandsByCode.get</font><font color="#000000">(</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">.getName</font><font color="#000000">())</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Assert.assertEquals</font><font color="#000000">(</font><font color="#2a00ff">&#34;Retrieved&nbsp;Band's&nbsp;albumSales&nbsp;attribute&nbsp;incorrect&#34;</font><font color="#000000">,&nbsp;ALBUMS_SOLD,&nbsp;bandsByCode.get</font><font color="#000000">(</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">.getAlbumSales</font><font color="#000000">())</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Assert.assertEquals</font><font color="#000000">(</font><font color="#2a00ff">&#34;Retrieved&nbsp;Band's&nbsp;history&nbsp;attribute&nbsp;incorrect&#34;</font><font color="#000000">,&nbsp;BAND_HISTORY,&nbsp;bandsByCode.get</font><font color="#000000">(</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">.getHistory</font><font color="#000000">())</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#646464">@Test</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testFindBands_EmptyStringParam</font><font color="#000000">()</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">{</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//calling&nbsp;findBandsByCode()&nbsp;with&nbsp;an&nbsp;empty&nbsp;String&nbsp;-&nbsp;returns&nbsp;no&nbsp;results</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>final&nbsp;</b></font><font color="#000000">List&lt;BandModel&gt;&nbsp;bands&nbsp;=&nbsp;bandDAO.findBandsByCode</font><font color="#000000">(</font><font color="#2a00ff">&#34;&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Assert.assertTrue</font><font color="#000000">(</font><font color="#2a00ff">&#34;No&nbsp;Band&nbsp;should&nbsp;be&nbsp;returned&#34;</font><font color="#000000">,&nbsp;bands.isEmpty</font><font color="#000000">())</font><font color="#000000">;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br />
<font color="#ffffff">&nbsp;</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#646464">@Test</font><font color="#000000">(</font><font color="#000000">expected&nbsp;=&nbsp;IllegalArgumentException.</font><font color="#404040"><b>class</b></font><font color="#000000">)</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#404040"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testfindBands_NullParam</font><font color="#000000">()</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">{</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//calling&nbsp;findBandByCode&nbsp;with&nbsp;null&nbsp;should&nbsp;throw&nbsp;an&nbsp;IllegalArgumentException</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bandDAO.findBandsByCode</font><font color="#000000">(</font><font color="#404040"><b>null</b></font><font color="#000000">)</font><font color="#000000">;&nbsp;</font><font color="#3f7f5f">//method's&nbsp;return&nbsp;value&nbsp;not&nbsp;captured</font><br />
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br />
<font color="#000000">}</font></code><span class="codenote">Source: concerttours.daos.impl.DefaultBandDAOIntegrationTest</span></span>